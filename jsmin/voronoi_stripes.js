"use strict";var _slicedToArray=function(arr,i){if(Array.isArray(arr))return arr;if(Symbol.iterator in Object(arr))return function(arr,i){var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{!_n&&_i.return&&_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")},isNode="undefined"!=typeof module;if(isNode)var colours=require("./colours.js"),dom=require("./dom.js"),rand=require("./rand.js");var voronoi_stripes=function(){return function(){var r=rand.instance(),c=colours.instance(r),dot=1,stage=dom.canvas(1,1),canvas=stage.canvas,ctx=stage.ctx,settings={},size=void 0,sizeX=void 0,sizeY=void 0;function positionPoint(index,total){var dim=Math.floor(Math.sqrt(total)),x=index%dim+.5,y=Math.floor(index/dim)+.5,blockX=sizeX/dim/dot,blockY=sizeY/dim/dot,centreX=sizeX/2/dot,centreY=sizeY/2/dot,radius=index/total*centreX,angle=index/total*Math.PI*index*(.5+r.getNumber(0,20));return[[r.getNumber(0,sizeX),r.getNumber(0,sizeY)],[centreX+Math.sin(angle)*sizeX/3,centreY+Math.cos(angle)*sizeY/3],[centreX+Math.sin(angle)*radius,centreY+Math.cos(angle)*radius],[(x-settings.pointBias/2+r.getNumber(0,settings.pointBias))*blockX,(y-settings.pointBias/2+r.getNumber(0,settings.pointBias))*blockY]][settings.pointMethod]}function renderRegion(region,bounds){var x=bounds.x,y=bounds.y,width=bounds.width,height=bounds.height;if(isNaN(x)||isNaN(y)||isNaN(width)&&isNaN(height))return null;var pattern=fillDither({c:c,r:r,size:(height<width?width:height)+10,settings:settings}),regionCanvas=dom.canvas(width+10,height+10),imageData=regionCanvas.ctx.getImageData(0,0,width+10,height+10);region.forEach(function(_ref){var _ref2=_slicedToArray(_ref,2),rx=_ref2[0],xp=4*((_ref2[1]-y)*(width+10)+(rx-x));imageData.data[xp]=255,imageData.data[xp+1]=255,imageData.data[xp+3]=255}),regionCanvas.ctx.putImageData(imageData,0,0),regionCanvas.ctx.globalCompositeOperation="source-in",regionCanvas.ctx.drawImage(pattern,0,0),ctx.drawImage(regionCanvas.canvas,x,y)}return{init:function(options){size=options.size,sizeY=sizeX=size,r.setSeed(options.seed),c.getRandomPalette(),stage.setSize(sizeX,sizeY),settings.baseRotation=2*Math.PI,settings.lineGap=r.getNumber(1,101),settings.lineSize=r.getNumber(1,101),settings.overallScale=r.getNumber(50,200),settings.lineScale=settings.overallScale,settings.pointBias=r.getNumber(0,2),settings.pointMethod=0,settings.varyDuotone=!1,settings.varyPerLine=!1,settings.varyPerRegion=!1,settings.varyRotation=Math.PI*(.5<r.random()?2:.2),settings.varyDuotone&&c.setRandomPalette(0),settings.sites=16+r.getNumber(0,20),voronoi.init({dot:dot,sites:settings.sites,sizeX:sizeX,sizeY:sizeY,debug:!1}),voronoi.genPoints(positionPoint),voronoi.genMap(),voronoi.drawRegions(renderRegion)},settings:settings,stage:canvas,update:function(){}}}};isNode?module.exports=voronoi_stripes():define("voronoi_stripes",voronoi_stripes);