"use strict";var progressBar,progress=function(eventName,eventParam){switch(con.log("experiments progress",eventName,eventParam),eventName){case"render:progress":progressBar.style.width=100*eventParam+"%",progressBar.style.height="10px";break;case"render:complete":progressBar.style.height="0px"}},exps=function(experimentsDetails){var experiments=experimentsDetails.list;return function(){var info,currentExperiment,seed,interactedShowing=!1,viewSource=!1;progressBar=dom.element("div",{id:"progress",style:{width:0,height:0}}),document.body.appendChild(progressBar);var holder=dom.element("div",{id:"experiment-holder"});document.body.appendChild(holder);var buttonsNav=dom.element("div",{className:"exps-buttons"});document.body.appendChild(buttonsNav);var buttonClose=dom.button("X",{className:"exps-button"});buttonsNav.appendChild(buttonClose),dom.on(buttonClose,["click","touchend"],function(){window.location="/"+(viewSource?"?src":"")});var buttonInfo=dom.button("?",{className:"exps-button"});buttonsNav.appendChild(buttonInfo),dom.on(buttonInfo,["click","touchend"],showInfo);var panelInfo=dom.element("div",{className:"exps-info"}),panelInfoDetails=dom.element("div",{className:"exps-info-details"}),panelNav=dom.element("div",{className:"exps-buttons interacted"}),panelButtonClose=dom.button("X",{className:"exps-button"});dom.on(panelButtonClose,["click","touchend"],hideInfo),document.body.appendChild(panelInfo),panelInfo.appendChild(panelNav),panelNav.appendChild(panelButtonClose),panelInfo.appendChild(panelInfoDetails);var loadExperiment=function(index){var src=experiments[index];src.toString().includes("css:")&&(src=src.filter(function(file){var s,link,isCSS=file.includes("css:");return isCSS&&(s=file.replace("css:",""),(link=dom.element("link")).rel="stylesheet",link.type="text/css",link.href="css/"+s+".css",document.head.appendChild(link)),!isCSS})),require(src,function(experiment){experiment?experimentLoaded(experiment):con.warn("require loaded... but experiment is null",experiment)})},showButtons=function(){for(var e in buttonClose.style.display="none",buttonInfo.style.display="none",experiments){var button=dom.element("button",{className:"exp"});dom.on(button,["click"],function(event){window.location="?"+event.target.key+(viewSource?"&src":"")});var key=experiments[e][0],title=key,expDetails=experimentsDetails.getDetails(key);expDetails&&expDetails.title&&(title=expDetails.title),button.key=key,button.innerHTML=title,document.body.appendChild(button)}},showInfo=function(){!0,panelInfo.classList.add("displayed"),panelInfoDetails.innerHTML="\n<h4>Experimental Graphics</h4>\n<h1>"+info.title+"</h1>\n"+info.description+"\n<p><a href='https://github.com/raurir/experimental-graphics/blob/master/js/"+info.key+".js' target='_blank'>SRC on Github</a></p>"},hideInfo=function(){panelInfo.classList.remove("displayed"),!1},resize=function(){var sw=window.innerWidth,sh=window.innerHeight;currentExperiment.resize&&currentExperiment.resize(sw,sh)},experimentLoaded=function(exp){(currentExperiment="function"==typeof exp?exp():exp).stage?holder.appendChild(currentExperiment.stage):con.warn("experimentLoaded, but no stage:",currentExperiment.stage),dom.on(window,["resize"],resize),currentExperiment.init({progress:progress,seed:seed,size:800}),resize()};return function(){if(window.location.search){var params=window.location.search.split("?")[1].split("&"),key=params[0],index=0,found=!1,keyWithSeed=key.split(",");if((viewSource=params.filter(function(param){return"src"===param}).length)&&con.log("`src` in url: Experimental graphics in SRC mode..."),"src"===key)return showButtons();for(keyWithSeed[1]&&(key=keyWithSeed[0],seed=keyWithSeed[1],rand.setSeed(seed),con.log("found key, seed",rand));index<experiments.length&&0==found;)experiments[index][0]==key?found=!0:index++;loadExperiment(index),(info=experimentsDetails.getDetails(key))?info.key=key:buttonsNav.removeChild(buttonInfo),dom.on(document.body,["click","touchstart"],function(){interactedShowing||(interactedShowing=!0,buttonsNav.classList.add("interacted"))})}else showButtons()}(),{load:loadExperiment,experiments:experiments}}};define("exps",["exps_details"],exps);