"use strict";define("aegean_sun",["perlin"],function(perlin){var rndI=rand.instance();rndI.setSeed(Math.random());var c=colours.instance(rndI),sw=window.innerWidth,sh=window.innerHeight,w=sw,h=sh,channelX=perlin.noise(w,h),channelY=perlin.noise(w,h),cols=(rndI.getInteger(100,300),rndI.getInteger(4,10),Math.floor(sw*sh/200),c.getRandomPalette()),canvas=dom.canvas(sw,sh),ctx=canvas.ctx;return{init:function(){var bg=c.getRandomColour();cols.splice(cols.indexOf(bg),1),ctx.fillStyle=bg,ctx.fillRect(0,0,sw,sh),ctx.strokeStyle=c.getNextColour(),function(t){ctx.clearRect(0,0,sw,sh);var noiseX=channelX.cycle(1e-6*t,.005),noiseY=channelY.cycle(1e-5*t,.004);function recurse(line,offset){for(var segments=line.length,nextLine=[],i=0;i<segments;i++){var p={x:line[i].x+offset.x,y:line[i].y+offset.y},noiseIndex=Math.floor(p.y*w+p.x),x=2*(noiseX[noiseIndex]-.5),y=0*(noiseY[noiseIndex]-.5);p.x+=x,p.y+=y,nextLine.push(p)}return renderLine(nextLine),nextLine}function renderLine(line){var segments=line.length;ctx.beginPath();for(var i=0;i<segments;i++){var p=line[i];0==i?ctx.moveTo(p.x,p.y):ctx.lineTo(p.x,p.y)}ctx.stroke()}for(var line=function(){for(var p0={x:rndI.getNumber(.4,.6)*w,y:0*h},p1={x:rndI.getNumber(.4,.6)*w,y:1*h},line=[],i=0;i<20;i++){var p=geom.lerp(p0,p1,i/20);line.push(p)}return renderLine(line),line}(),next=line,prev=line,i=0;i<40;i++)next=recurse(next,{x:4,y:0}),prev=recurse(prev,{x:-4,y:0})}(0)},stage:canvas.canvas}});