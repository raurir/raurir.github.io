"use strict";var perlin_dots=function(perlin){var w=30,c=dom.canvas(600,600),d=c.ctx,dots=[],channelRed=perlin.noise(w,30),red=(perlin.noise(w,30),perlin.noise(w,30),channelRed.cycle(1,.03)),drawFrame=function drawFrame(time){requestAnimationFrame(drawFrame),function(time){for(var i=0;i<900;i++){var xp=i%w,yp=Math.floor(i/w),r=~~(255*red[i]),g=~~(255*red[i]),b=~~(255*red[i]);d.fillStyle="rgb("+r+","+g+","+b+")",d.fillRect(20*xp,20*yp,20,20)}}(),drawDots()};var drawDots=function(){dots=dots.map(function(dotA){var pressure={x:0,y:0},pa=dotA.position();return dots.forEach(function(dotB){if(dotA!==dotB){var pb=dotB.position(),dx=pb.x-pa.x,dy=pb.y-pa.y,d=Math.hypot(dx,dy);if(!(d<1||200<d)){var xi=Math.floor(pa.x/20),i=Math.floor(pa.y/20)*w+xi;if(red[i]){var attraction=.008*(red[i]-.5);pressure.x+=dx/d*attraction,pressure.y+=dy/d*attraction}}}}),dotA.move(pressure),dotA.draw(),dotA})},generateDot=function(){var x=600*Math.random(),y=600*Math.random();return{position:function(){return{x:x,y:y}},draw:function(){d.fillStyle="#000",d.fillRect(x,y,2,2)},move:function(distance){x+=distance.x,y+=distance.y}}};return{init:function(){for(var i=0;i<400;i++)dots.push(generateDot());drawFrame()},stage:c.canvas}};define("perlin_dots",["perlin"],perlin_dots);